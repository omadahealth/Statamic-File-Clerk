/*! =========================================================
 * s3-files v0.0.1
 * A simple Amazon S3 add-on for Statamic
 * http://chadjclark.com
 * =========================================================
 * Copyright (c) 2014 Chad Clark
 *
 * This file built on 2014-01-26
 * ========================================================= */
$(function(){function a(a){e=a.target.files,console.log(e)}function b(a){a.stopPropagation(),a.preventDefault();var b=new FormData;$.each(e,function(a,c){b.append(a,c)}),$.ajax({url:$(".s3files #postUrl").val(),type:"POST",data:b,cache:!1,dataType:"JSON",xhr:function(){var a=$.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",c,!1),a},processData:!1,contentType:!1,beforeSend:function(a){console.log(a),$(".fileinput").addClass("is-hidden"),$(".progress").removeClass("is-hidden").addClass("is-visible")},success:function(a){"undefined"==typeof a.error?(console.log(a.success),console.log("URL: "+a.fullpath),d($("#fileupload")),$("progress").removeClass("uploading"),$(".progress-filename p").html("Upload complete. <strong>"+a.filename+"</strong> was uploaded successfully."),$(".progress-bar").addClass("is-hidden"),$(".result input#successful-upload").val(a.fullpath)):console.log("ERRORS: "+a.error)},error:function(a,b){console.log("ERRORS: "+b)}})}function c(a){if(a.lengthComputable){var b=parseInt(a.loaded/a.total*100,10);console.log(b+"%"),$("progress").attr({value:a.loaded,max:a.total}),$(".prc").html(b+"%")}}function d(a){a.wrap("<form>").parent("form").trigger("reset"),a.unwrap()}var e;$(".s3files #fileupload").on("change",a),$(".s3files #doit").click(b)});